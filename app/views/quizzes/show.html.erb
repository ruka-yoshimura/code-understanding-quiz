<div class="max-w-4xl mx-auto space-y-6" data-controller="quiz">
  <div class="flex items-center justify-between px-4 md:px-0">
    <%= link_to "â† æˆ»ã‚‹", "javascript:history.back()", class: "text-slate-400 hover:text-white transition-colors text-sm font-medium flex items-center gap-2" %>
    <span class="text-xs font-mono text-slate-500 bg-white/5 px-2 py-1 rounded">QUIZ ID: #<%= @quiz.id %></span>
  </div>

  <div class="glass p-6 md:p-10 rounded-3xl">
    <div class="mb-10 text-center max-w-2xl mx-auto">
      <h1 class="text-2xl md:text-3xl font-black text-white mb-4 leading-snug break-words w-full max-w-full">
        <%= markdown(@quiz.question) %>
      </h1>
      <% if ['beginner@example.com', 'expert@example.com'].include?(current_user.email) %>
      <p class="text-emerald-400 text-xs font-bold bg-emerald-500/10 inline-block px-3 py-1 rounded-full border border-emerald-500/20">
        â€» ãƒ‡ãƒ¢ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãŸã‚ã€æ­£è§£ã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™
      </p>
      <% end %>
    </div>

    <div class="mb-10 relative group">
      <div class="absolute -inset-2 bg-gradient-to-r from-primary/20 via-blue-500/20 to-primary/20 rounded-2xl blur-xl opacity-50 group-hover:opacity-100 transition duration-1000"></div>
      <div class="relative bg-slate-950 rounded-2xl overflow-hidden border border-white/10 shadow-3xl">
        <div class="flex items-center gap-2 px-4 py-2 bg-slate-900 border-b border-white/5">
          <div class="flex gap-1.5">
            <div class="w-3 h-3 rounded-full bg-rose-500/50"></div>
            <div class="w-3 h-3 rounded-full bg-amber-500/50"></div>
            <div class="w-3 h-3 rounded-full bg-emerald-500/50"></div>
          </div>
          <span class="text-[10px] font-mono text-slate-500 ml-4 font-bold tracking-widest uppercase italic">app/logic/main.rb</span>
        </div>
        <div class="p-6 md:p-8 overflow-x-auto">
          <pre class="font-mono text-sm leading-relaxed"><code class="text-slate-200"><%= @quiz.original_code %></code></pre>
        </div>
      </div>
    </div>

    <div class="space-y-4 max-w-2xl mx-auto">
      <h2 class="text-sm font-black text-slate-500 uppercase tracking-widest text-center mb-6">ç­”ãˆã‚’é¸ã‚“ã§ãã ã•ã„</h2>
      <div class="grid grid-cols-1 gap-3">
        <% [@quiz.answer, @quiz.option_1, @quiz.option_2].shuffle.each do |option| %>
        <%= button_to answer_quiz_path(@quiz, is_correct: option == @quiz.answer),
                        method: :post,
                        data: {
                          turbo_stream: true,
                          quiz_target: "option",
                          action: "click->quiz#submit",
                          is_correct: option == @quiz.answer
                        },
                        class: "w-full text-left p-5 rounded-2xl border-2 border-white/5 bg-white/5 hover:bg-white/10 hover:border-primary/50 transition-all font-bold text-slate-200 group flex justify-between items-center group cursor-pointer" do %>
        <span><%= option %></span>
        <% if ['beginner@example.com', 'expert@example.com'].include?(current_user.email) && option == @quiz.answer %>
        <span class="text-[10px] uppercase font-bold text-emerald-400/50 group-hover:text-emerald-400 transition-colors">ï¼ˆæ­£è§£ï¼‰</span>
        <% end %>
        <div class="w-6 h-6 rounded-full border border-white/10 flex items-center justify-center text-[10px] group-hover:bg-primary/20 transition-all opacity-0 group-hover:opacity-100">
          âš¡ï¸
        </div>
        <% end %>
        <% end %>
      </div>
    </div>

    <div id="explanation" class="mt-12 max-w-2xl mx-auto hidden" data-quiz-target="explanation">
      <div class="p-8 rounded-3xl bg-primary/5 border border-primary/20 space-y-6">
        <h3 class="text-xl font-black text-primary flex items-center gap-3">
          <span class="text-2xl">ğŸ’¡</span> è§£èª¬
        </h3>
        <div class="text-slate-300 leading-relaxed prose prose-invert max-w-none">
          <%= markdown(@quiz.explanation) %>
        </div>
        <div class="pt-6 border-t border-primary/20">
          <%= link_to root_path, class: "btn-primary w-full block text-center py-4" do %>
          ãƒ›ãƒ¼ãƒ ç”»é¢ã¸æˆ»ã£ã¦ãƒ¬ãƒ™ãƒ«ã‚’ç¢ºèªã™ã‚‹
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  /* AIç”Ÿæˆå•é¡Œã®å•é¡Œæ–‡ã«å«ã¾ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ã¯ã¿å‡ºã—é˜²æ­¢ & è£…é£¾ */

  /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ (`code`) */
  h1 code {
    display: inline;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
    background-color: rgba(255, 255, 255, 0.15) !important;
    padding: 0.2em 0.4em !important;
    border-radius: 0.3em !important;
    white-space: pre-wrap !important;
    /* æŠ˜ã‚Šè¿”ã—è¨±å¯ */
    word-break: break-word !important;
    /* è‹±å˜èªã®é€”ä¸­ã§ã‚‚æŠ˜ã‚Šè¿”ã™ */
    overflow-wrap: anywhere !important;
    font-size: 0.85em !important;
    /* å°‘ã—å°ã•ãã—ã¦å¼·èª¿ */
    vertical-align: baseline;
    box-decoration-break: clone;
    -webkit-box-decoration-break: clone;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
  }

  /* ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰ (`pre`) */
  h1 pre {
    display: block !important;
    width: 100% !important;
    max-width: 100% !important;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
    background-color: rgba(15, 23, 42, 0.6) !important;
    /* èƒŒæ™¯ã‚’æ¿ƒã */
    padding: 1rem !important;
    border-radius: 0.75rem !important;
    margin: 1rem 0 !important;
    white-space: pre-wrap !important;
    word-break: break-all !important;
    overflow-wrap: anywhere !important;
    box-sizing: border-box !important;
    text-align: left !important;
    /* ã‚³ãƒ¼ãƒ‰ã¯å·¦å¯„ã› */
    font-size: 0.75em !important;
    /* ãƒ–ãƒ­ãƒƒã‚¯ã‚³ãƒ¼ãƒ‰ã¯å°ã•ã‚ã« */
    line-height: 1.6 !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
  }

  /* pre ã®ä¸­ã® code ã¯ pre ã®ã‚¹ã‚¿ã‚¤ãƒ«ã«å¾“ã† */
  h1 pre code {
    background-color: transparent !important;
    padding: 0 !important;
    border-radius: 0 !important;
    font-size: inherit !important;
    white-space: inherit !important;
    word-break: inherit !important;
    border: none !important;
    font-family: inherit !important;
  }
</style>
